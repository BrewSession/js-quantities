<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>JS-quantities by gentooboontoo</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>JS-quantities</h1>
        <p>JavaScript library for quantity calculation and unit conversion</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/gentooboontoo/js-quantities" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/gentooboontoo/js-quantities/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/gentooboontoo/js-quantities/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>
<a name="js-quantities" class="anchor" href="#js-quantities"><span class="octicon octicon-link"></span></a>JS-quantities</h1>

<p><a href="https://travis-ci.org/gentooboontoo/js-quantities"><img src="https://travis-ci.org/gentooboontoo/js-quantities.png" alt="Build Status"></a></p>

<p>JS-quantities is originally a JavaScript port of Kevin Olbrich's library Ruby
Units (<a href="http://ruby-units.rubyforge.org/ruby-units">http://ruby-units.rubyforge.org/ruby-units</a>).</p>

<p>The library aims to simplify the handling of units for scientific calculations
involving quantities.</p>

<p>JS-quantities is defined as an UMD module and can be used with AMD, Node
and within browsers.</p>

<h2>
<a name="installing-js-quantities" class="anchor" href="#installing-js-quantities"><span class="octicon octicon-link"></span></a>Installing JS-quantities</h2>

<h3>
<a name="browser" class="anchor" href="#browser"><span class="octicon octicon-link"></span></a>Browser</h3>

<p>Download at <a href="https://raw.github.com/gentooboontoo/js-quantities/v1.1.0/src/quantities.js">latest release</a>.</p>

<p>You could also use Bower to install:</p>

<pre><code>bower install js-quantities
</code></pre>

<p>Then include it:</p>

<pre><code>&lt;script src='quantities.js'&gt;&lt;/script&gt;
</code></pre>

<p>When using <a href="http://requirejs.org/">Require.JS</a>:</p>

<pre><code>define(['quantities'], function(Qty) {
  ...
});
</code></pre>

<h3>
<a name="node" class="anchor" href="#node"><span class="octicon octicon-link"></span></a>Node</h3>

<pre><code>$ npm install js-quantities
$ node
&gt; var Qty = require('js-quantities);
</code></pre>

<h2>
<a name="synopsis" class="anchor" href="#synopsis"><span class="octicon octicon-link"></span></a>Synopsis</h2>

<h3>
<a name="creation" class="anchor" href="#creation"><span class="octicon octicon-link"></span></a>Creation</h3>

<p>Instances of quantities are made by means of Qty() method. Qty can both be used
as a constructor (with new) or as a factory (without new):</p>

<pre><code>qty = new Qty('23 ft'); // constructor
qty = Qty('23 ft'); // factory
</code></pre>

<p>For the sake of simplicity, one will use the factory way below but using
new Qty() is equivalent.</p>

<pre><code>qty = Qty('1m'); // =&gt; 1 meter
qty = Qty('m'); // =&gt;  1 meter (scalar defaults to 1)

qty = Qty('1 N*m');
qty = Qty('1 N m'); // * is optional

qty = Qty('1 m/s');

qty = Qty('1 m^2/s^2');
qty = Qty('1 m^2 s^-2'); // negative powers
qty = Qty('1 m2 s-2'); // ^ is optional

qty = Qty('1 m^2 kg^2 J^2/s^2 A');

qty = Qty('1.5'); // unitless quantity

qty = Qty('1 attoparsec/microfortnight');
</code></pre>

<h3>
<a name="quantity-compatibility-kind-and-various-queries" class="anchor" href="#quantity-compatibility-kind-and-various-queries"><span class="octicon octicon-link"></span></a>Quantity compatibility, kind and various queries</h3>

<pre><code>qty1.isCompatible(qty2); // =&gt; true or false

qty.kind(); // =&gt; 'length', 'area', etc...

qty.isUnitless(); // =&gt; true or false
qty.isBase(); // =&gt; true if quantity is represented with base units
</code></pre>

<h3>
<a name="conversion" class="anchor" href="#conversion"><span class="octicon octicon-link"></span></a>Conversion</h3>

<pre><code>qty.toBase(); // converts to SI units (10 cm =&gt; 0.1 m) (new instance)

qty.toFloat(): // returns scalar of unitless quantity (otherwise throws error)

qty.to('m'); // converts quantity to meter if compatible
             // or throws an error (new instance)
qty1.to(qty2); // converts quantity to same unit of qty2 if compatible
               // or throws an error (new instance)

qty.inverse(); // converts quantity to its inverse ('100 m/s' =&gt; '.01 s/m')
// inverses can be used, but there is no special checking to rename the units
Qty('10ohm').inverse() // '.1/ohm' (not '.1S', although they are equivalent)
// however, the 'to' command will convert between inverses also
Qty('10ohm').to('S') // '.1S'
</code></pre>

<p>Qty.swiftConverter() could be useful to efficiently convert large array of values. It
configures a function accepting a value and converting it.</p>

<pre><code>var convert = Qty.swiftConverter('m/h', 'ft/s'); // Configures converter
var convertedSerie = largeSerie.map(convert); // Usage with map()
var converted = convert(2500); // Standalone usage
</code></pre>

<p>The main drawback of this conversion method is that it does not take care of
rounding issues.</p>

<h3>
<a name="comparison" class="anchor" href="#comparison"><span class="octicon octicon-link"></span></a>Comparison</h3>

<pre><code>qty1.eq(qty2); // =&gt; true if both quantities are equal (1m == 100cm =&gt; true)
qty1.same(qty2); // =&gt; true if both quantities are same (1m == 100cm =&gt; false)
qty1.lt(qty2); // =&gt; true if qty1 is stricty less than qty2
qty1.lte(qty2); // =&gt; true if qty1 is less than or equal to qty2
qty1.gt(qty2); // =&gt; true if qty1 is stricty greater than qty2
qty1.gte(qty2); // =&gt; true if qty1 is greater than or equal to qty2

qty1.compareTo(qty2); // =&gt; -1 if qty1 &lt; qty2, 0 if qty1 == qty2; 1 if qty1 &gt; qty2
</code></pre>

<h3>
<a name="operators" class="anchor" href="#operators"><span class="octicon octicon-link"></span></a>Operators</h3>

<ul>
<li>add(other): Add. other can be string or quantity. other should be unit compatible.</li>
<li>sub(other): Substract. other can be string or quantity. other should be unit compatible.</li>
<li>mul(other): Multiply. other can be string, number or quantity.</li>
<li>div(other): Divide. other can be string, number or quantity.</li>
</ul><h3>
<a name="rounding" class="anchor" href="#rounding"><span class="octicon octicon-link"></span></a>Rounding</h3>

<p>Qty#toPrec(precision) : returns the nearest multiple of quantity passed as precision</p>

<pre><code>var qty = Qty('5.17 ft');
qty.toPrec('ft'); // =&gt; 5 ft
qty.toPrec('0.5 ft'); // =&gt; 5 ft
qty.toPrec('0.25 ft'); // =&gt; 5.25 ft
qty.toPrec('0.1 ft'); // =&gt; 5.2 ft
qty.toPrec('0.05 ft'); // =&gt; 5.15 ft
qty.toPrec('0.01 ft'); // =&gt; 5.17 ft
qty.toPrec('0.00001 ft'); // =&gt; 5.17 ft
qty.toPrec('2 ft'); // =&gt; 6 ft
qty.toPrec('2'); // =&gt; 6 ft

var qty = Qty('6.3782 m');
qty.toPrec('dm'); // =&gt; 6.4 m
qty.toPrec('cm'); // =&gt; 6.38 m
qty.toPrec('mm'); // =&gt; 6.378 m
qty.toPrec('5 cm'); // =&gt; 6.4 m
qty.toPrec('10 m'); // =&gt; 10 m
qty.toPrec(0.1); // =&gt; 6.3 m

var qty = Qty('1.146 MPa');
qty.toPrec('0.1 bar'); // =&gt; 1.15 MPa
</code></pre>

<h3>
<a name="formatting-quantities" class="anchor" href="#formatting-quantities"><span class="octicon octicon-link"></span></a>Formatting quantities</h3>

<p>Qty#toString returns a string using the canonical form of the quantity (that
is it could be seamlessly reparsed by Qty).</p>

<pre><code>var qty = Qty('1.146 MPa');
qty.toString(); // =&gt; '1.146 MPa'
</code></pre>

<p>As a shorthand, units could be passed to Qty#toString and is equivalent to
successively call Qty#to then Qty#toString.</p>

<pre><code>var qty = Qty('1.146 MPa');
qty.toString('bar'); // =&gt; '11.46 bar'
qty.to('bar').toString(); // =&gt; '11.46 bar'
</code></pre>

<p>Qty#toString could also be used with any method from Qty to make some sort of
formatting. For instance, one could use Qty#toPrec to fix the maximum number of
decimals:</p>

<pre><code>var qty = Qty('1.146 MPa');
qty.toPrec(0.1).toString(); // =&gt; '1.1 MPa'
qty.to('bar').toPrec(0.1).toString(); // =&gt; '11.5 bar'
</code></pre>

<p>For advanced formatting needs as localization, specific rounding or any other
custom customization, quantities can be transformed into strings through
Qty#format according to optional target units and formatter. If target units are
specified, the quantity is converted into them before formatting.</p>

<p>Such a string is not intended to be reparsed to construct a new instance of Qty
(unlike output of Qty#toString).</p>

<p>If no formatter is specified, quantities are formatted according to default
js-quantities' formatter and is equivalent to Qty#toString.</p>

<pre><code>var qty = Qty('1.1234 m');
qty.format(); // same units, default formatter =&gt; '1.234 m'
qty.format('cm'); // converted to 'cm', default formatter =&gt; '123.45 cm'
</code></pre>

<p>Qty#format could delegates formatting to a custom formatter if required. A
formatter is a callback function accepting scalar and units as parameters and
returning a formatted string representing the quantity.</p>

<pre><code>var configurableRoundingFormatter = function(maxDecimals) {
  return function(scalar, units) {
    var pow = Math.pow(10, maxDecimals);
    var rounded = Math.round(scalar * pow) / pow;

    return rounded + ' ' + units;
  };
};

var qty = Qty('1.1234 m');

// same units, custom formatter =&gt; '1.12 m'
qty.format(configurableRoundingFormatter(2));

// convert to 'cm', custom formatter =&gt; '123.4 cm'
qty.format('cm', configurableRoundingFormatter(1));
</code></pre>

<p>Custom formatter can be configured globally by setting Qty.formatter.</p>

<pre><code>Qty.formatter = configurableRoundingFormatter(2);
var qty = Qty('1.1234 m');
qty.format(); // same units, current default formatter =&gt; '1.12 m'
</code></pre>

<h3>
<a name="temperatures" class="anchor" href="#temperatures"><span class="octicon octicon-link"></span></a>Temperatures</h3>

<p>Like ruby-units, JS-quantities makes a distinction between a temperature (which technically is a property) and degrees of temperature (which temperatures are measured in).</p>

<p>Temperature units (i.e., 'tempK') can be converted back and forth, and will take into account the differences in the zero points of the various scales. Differential temperature (e.g., '100 degC') units behave like most other units.</p>

<pre><code>Qty('37 tempC').to('tempF')      #=&gt; 98.6 tempF
</code></pre>

<p>JS-quantities will throw an error if you attempt to create a temperature unit that would fall below absolute zero.</p>

<p>Unit math on temperatures is fairly limited.</p>

<pre><code>Qty('100 tempC').add('10 degC')  # 110 tempC
Qty('100 tempC').sub('10 degC')  # 90 tempC
Qty('100 tempC').add('50 tempC') # throws error
Qty('100 tempC').sub('50 tempC') # 50 degC
Qty('50 tempC').sub('100 tempC') # -50 degC
Qty('100 tempC').mul(scalar)     # 100*scalar tempC
Qty('100 tempC').div(scalar)     # 100/scalar tempC
Qty('100 tempC').mul(qty)        # throws error
Qty('100 tempC').div(qty)        # throws error
Qty('100 tempC*unit')            # throws error
Qty('100 tempC/unit')            # throws error
Qty('100 unit/tempC')            # throws error
Qty('100 tempC').inverse()       # throws error

Qty('100 tempC').to('degC') #=&gt; 100 degC
</code></pre>

<p>This conversion references the 0 point on the scale of the temperature unit</p>

<pre><code>Qty('100 degC').to('tempC') #=&gt; -173.15 tempC
</code></pre>

<p>These conversions are always interpreted as being relative to absolute zero.
Conversions are probably better done like this...</p>

<pre><code>Qty('0 tempC').add('100 degC') #=&gt; 100 tempC
</code></pre>

<h3>
<a name="errors" class="anchor" href="#errors"><span class="octicon octicon-link"></span></a>Errors</h3>

<p>Every error thrown by JS-quantities is an instance of Qty.Error.</p>

<pre><code>try {
  // code triggering an error inside JS-quantities
}
catch(e) {
  if(e instanceof Qty.Error) {
    // ...
  }
  else {
    // ...
  }
}
</code></pre>

<h2>
<a name="tests" class="anchor" href="#tests"><span class="octicon octicon-link"></span></a>Tests</h2>

<p>Tests are implemented with Jasmine (<a href="https://github.com/pivotal/jasmine">https://github.com/pivotal/jasmine</a>).
You could use both HTML and jasmine-node runners.</p>

<p>To execute specs through HTML runner, just open SpecRunner.html file in a
browser to execute them.</p>

<p>To execute specs through node-jasmine, launch:</p>

<pre><code>jasmine-node spec/
</code></pre>

<h3>
<a name="performance-regression-test" class="anchor" href="#performance-regression-test"><span class="octicon octicon-link"></span></a>Performance regression test</h3>

<p>There is a small benchmarking HTML page to spot performance regression between
currently checked-out quantities.js and any committed version.
Just execute:</p>

<pre><code>bundle exec rake bench
</code></pre>

<p>then open <a href="http://0.0.0.0:3000/bench">http://0.0.0.0:3000/bench</a></p>

<p>Checked-out version is benchmarked against HEAD by default but it could be changed by passing
any commit SHA on the command line. Port (default 3000) is also configurable.</p>

<pre><code>bundle exec rake bench COMMIT=e0c7fc468 PORT=5000
</code></pre>

<h2>
<a name="contribute" class="anchor" href="#contribute"><span class="octicon octicon-link"></span></a>Contribute</h2>

<p>Feedback and contribution are welcomed.</p>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/gentooboontoo">gentooboontoo</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>